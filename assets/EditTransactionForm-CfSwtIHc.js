import{r,u as E,d as N,a as C,j as e,v}from"./index-BBnfrm9i.js";import{F,a as S,b as l,E as _}from"./formik.esm-BcKGEoCv.js";import{D}from"./react-datepicker-DgmR9Bdx.js";import{c as M,a as O,d as y,I as T,_ as w}from"./index.esm-Co3wsXzJ.js";import P from"./CustomInputCalendar-CGAJl4iS.js";import{I as k}from"./Icon-D93qrst1.js";import X from"./Modal-C9nGsjwZ.js";import{s as A}from"./selectors-DIK-Bg5I.js";import"./hoist-non-react-statics.cjs-CR0WdkPu.js";import"./clsx-B-dksMZM.js";import"./floating-ui.dom-C4l1LKLb.js";const $="_modal_17bqi_2",V="_inputs_17bqi_6",R="_inputField_17bqi_17",z="_commentInput_17bqi_26",B="_inputData_17bqi_38",G="_dateInput_17bqi_46",H="_inputF_17bqi_17",J="_iconClose_17bqi_61",K="_error_17bqi_67",L="_title_17bqi_70",Q="_form_17bqi_77",U="_active_17bqi_83",W="_calendar_17bqi_87",Y="_div_17bqi_93",Z="_type_17bqi_102",ee="_span_17bqi_106",te="_save_17bqi_112",ae="_category_17bqi_138",se="_toggleContainer_17bqi_143",oe="_separator_17bqi_150",ne="_categorySelect_17bqi_163",ie="_column_17bqi_186",t={modal:$,inputs:V,inputField:R,commentInput:z,inputData:B,dateInput:G,inputF:H,iconClose:J,error:K,title:L,form:Q,active:U,calendar:W,div:Y,type:Z,span:ee,save:te,category:ae,toggleContainer:se,separator:oe,categorySelect:ne,column:ie},be=({transaction:s,closeModal:m})=>{var u;const[d,h]=r.useState(s?new Date(s.transactionDate):new Date),[o]=r.useState(s.type),[g,b]=r.useState(null),x=E(),c=N(A),{isMobile:q}=C();r.useEffect(()=>{if(c.length>0){const a=c.find(n=>n.type==="INCOME");b(a?a.id:null)}},[c]);const p=s?(u=c.find(a=>a.id===s.categoryId))==null?void 0:u.name:"",I=M({amount:O().required("Amount is required").positive("Amount must be positive"),comment:y().required("Comment is required"),category:y().when("transactionType",{is:"EXPENSE",then:a=>a.required("Category is required").nullable()})}),f=(a,{setSubmitting:n})=>{const i={id:s.id,transactionDate:d.toISOString(),type:o,categoryId:o==="INCOME"?g:s.categoryId,comment:a.comment,amount:o==="INCOME"?parseFloat(a.amount):-parseFloat(a.amount)};if(i.categoryId===null&&o==="EXPENSE"){n(!1);return}x(v(i)).unwrap().then(()=>{m(),n(!1)}).catch(j=>{w.error(j),n(!1)})};return e.jsxs("div",{children:[e.jsx(T,{}),e.jsxs(X,{closeModal:m,children:[!q&&e.jsx("div",{onClick:m,children:e.jsx(k,{id:"icon-close",width:16,height:16,className:t.iconClose})}),e.jsx("p",{className:t.title,children:"Edit transaction"}),e.jsxs("div",{className:t.toggleContainer,children:[e.jsx("span",{className:o==="INCOME"?t.active:"",children:"Income"}),e.jsx("span",{className:t.separator,children:"/"}),e.jsx("span",{className:o==="EXPENSE"?t.active:"",children:"Expense"})]}),e.jsx(F,{initialValues:{amount:s?Math.abs(s.amount):"",comment:s?s.comment:"",category:p,transactionType:o},validationSchema:I,onSubmit:f,children:({isSubmitting:a,setFieldValue:n})=>e.jsxs(S,{className:t.form,children:[o==="EXPENSE"&&e.jsx(l,{type:"text",name:"category",placeholder:"Category",className:t.inputF,readOnly:!0,value:p}),e.jsxs("div",{className:t.column,children:[e.jsxs("div",{className:t.inputs,children:[e.jsx(l,{type:"number",name:"amount",placeholder:"0.00",className:t.inputField}),e.jsx("div",{children:e.jsx(D,{selected:d,onChange:i=>{h(i),n("transactionDate",i)},dateFormat:"dd.MM.yyyy",className:t.dateInput,customInput:e.jsx(P,{})})})]}),e.jsx(_,{name:"amount",component:"div",className:t.error}),e.jsx(l,{type:"text",name:"comment",placeholder:"Comment",className:t.commentInput}),e.jsx(_,{name:"comment",component:"div",className:t.error})]}),e.jsx("button",{type:"submit",className:t.save,disabled:a,children:"SAVE"})]})})]})]})};export{be as default};
//# sourceMappingURL=EditTransactionForm-CfSwtIHc.js.map
